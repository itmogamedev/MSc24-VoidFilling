# Разработка алгоритма удаления строений на участках цифровых моделей рельефа с плотной городской застройкой

В работе реализован алгоритм удаления зданий из областей цифровых моделей поверхности с плотной городской застройкой на основе генеративно-состязательной нейронной сети. Такое решение позволяет пользователям осуществлять преобразование цифровых моеделей поверхности в цифрвоые модели рельефа в автоматическом режиме без необходимости прибегать к сложным манипуляциям в географических информационных системах или непосредственно программированию индивидуальных решений этой задачи.

Проект является частью выпускной квалификационной работы магистра по образовательной программе "Технологии разработки компьютерных игр" [Школы разработки видеоигр Университета ИТМО](https://itmo.games/).

## Предметная область и структра решения

Карты высот являются важным инструментом в различных научных дисциплинах: геологии, географии, гидрологии науках об окружающей среде, городском планировании и гражданском строительстве. Они обеспечивают трехмерное представление о земной поверхности и играют важную роль в процессах пространственного анализа.

Карты высот подразделяются на цифровые модели поверхности и цифровые модели рельефа. Разница между ними наглядно представлена на рисунке ниже.

![DSM vs DTM](/docs/img/dem_dsm.jpg)

Для решения большинства задач пространственного анализа используются именно цифровые модели рельефа, поэтому получаемые посредством различных способов сканирования цифрвоые модели поверхности подвергаются сложным преобразованиям, в ходе которых здания, растительность, вода и прочие объекты удаляются различными способами, а получившиеся под ними пустоты заполняются с помощью интерполяции.

Целью работы является в первую очередь упрощение и автоматизация процесса удаления зданий в областях цифровых моделей поверхности с плотной городской застройкой. В результате исследования существующих методов решения этой проблемы был предложен алгоритм, общая схема которого представлена на рисуке ниже.

![Схема алгоритма](/docs/img/alg_scheme.png)

## Средства реализации

Алгоритм был реализован с помощью фреймворка машинного обучения [PyTorch](https://pytorch.org/) на языке программирования [Python](https://www.python.org/) версии **3.12**.  

Для подготовки обучающего набора данных использовался глобальный датасет ***Copenicus 30m***, который был получен через публичный API [opentopography.org](https://opentopography.org/start), информация о городской застройке, полученная из открытой базы данных [Open Street Map](https://www.openstreetmap.org/#map=4/69.62/-74.90) и географическая информационная система [Quantum GIS](https://qgis.org/en/site/).

## Пример результатов работы алгоритма

![Results](/docs/img/results.jpg)

Исходная цифровая модель поверхности (слева). Обработанная нейросетью цифровая модель рельефа (справа).

## Инструкция по установке и запуску

Для запуска демонстрационной версии алгоритма необходимо выполнить следующие действия:

1. Загрузить менеджер пакетов Anaconda или его упрощённую версию Conda [по ссылке](https://www.anaconda.com/download/)
2. Выполнить его установку согласно инструкциям установщика
3. Загрузить содержимое репозитория на локальный компьютер. например, так:
        
        git clone https://github.com/vofks/VoidFilling.git

4. Запустить командную строку Anaconda Prompt
    
    ![anaconda prompt](/docs/img/Prompt.jpg)

5. Перейти в папку с ранее загруженным репозиторием при помощи команды `cd`
6. Создать и проинициализировать виртуальное окружение пакетного менеджера Anaconda при помощи команды

        conda env create -n voids -f env.yml

7. Затем необходимо дождаться окончания загрузки всех необходимых зависимостей и активировать виртуальное огружение при помощи команды

        conda activate voids

8. Далее необходимо запустить интерактивную веб-среду разработки [JupyterLab](https://jupyter.org/). Сделать это можно командой

        jupyter notebook

9. После этого должно открыться окно браузера с навигатором JupyterLab. Пример представлен на скриншоте ниже

    ![Jupyter](/docs/img/jupyter.jpg)

10. Далее необходимо пререйти в папку ***notebooks*** и открыть блокнот ***preview.ipynb***. Пример того, как это может выглядеть представлен на скриншоте ниже

    ![Notebook](/docs/img/notebook.jpg)

11. Запустить код и увидеть результат его работы можно, открыв меню `Run` в панели инструментов вверху страницы и нажав `Run All Cells`

    ![Run](/docs/img/run.jpg)

## Улучшения и дальнейшая разработка

- Применение набора цифровых моделей поверхности более высокого разрешения
- Реализация дополнительного функционала, например, удаление растительности
- Разработка плагина, который бы предоставлял удобный интерфейс для использования обученной модели в географической информационной системе

## Прочее
Работу выполнил: студент группы **J4222 Остапович Денис Евгеньевич**.  
Полный текст работы доступен по [ссылке](/docs/report.pdf).